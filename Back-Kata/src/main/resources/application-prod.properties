## Production profile overrides for AWS

# Server
server.port=${PORT:8080}

# Datasource (AWS RDS style env variables)
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:postgres}
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:postgres}

# JDBC optional properties (toggle SSL if your RDS requires it)
spring.datasource.hikari.maximum-pool-size=${DB_POOL_MAX_SIZE:10}
spring.datasource.hikari.minimum-idle=${DB_POOL_MIN_IDLE:2}

# JPA (TEMPORARY: Using update until Flyway is fixed)
spring.jpa.hibernate.ddl-auto=${JPA_DDL_AUTO:update}

# Flyway (DISABLED: Investigating why migrations don't run)
spring.flyway.enabled=false
# spring.flyway.baseline-on-migrate=true
# spring.flyway.locations=classpath:db/migration
spring.jpa.show-sql=${SHOW_SQL:false}

# Actuator
management.endpoints.web.exposure.include=health,info,metrics,prometheus
management.endpoint.health.show-details=when_authorized
management.endpoint.health.probes.enabled=true

# Metrics
management.metrics.export.cloudwatch.enabled=true
management.metrics.export.cloudwatch.namespace=back-kata
management.metrics.export.cloudwatch.batch-size=20

# CORS (override with env)
app.cors.allowed-origins=${ALLOWED_ORIGINS:*}
app.cors.allowed-methods=${ALLOWED_METHODS:GET,POST,PUT,PATCH,DELETE,OPTIONS}
app.cors.allowed-headers=${ALLOWED_HEADERS:*}
app.cors.allow-credentials=${ALLOW_CREDENTIALS:true}

# Security
security.bcrypt.strength=${BCRYPT_STRENGTH:10}

# Logging
logging.level.root=${LOG_LEVEL:INFO}
logging.level.org.springframework.security=${SEC_LOG_LEVEL:INFO}
